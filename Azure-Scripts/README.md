# Documentation for PowerShell Script to Collect Disk and Volume Information from VMs
#Overview
This PowerShell script is designed to collect and export disk and volume information from virtual machines (VMs) across multiple resource groups in Azure. It supports both Windows and Linux VMs, extracting specific details such as disk size, type, and volume health status, then compiles this information into a CSV file for easy analysis and reporting.

# Prerequisites
Azure CLI: The script uses Azure CLI commands to interact with Azure resources. Ensure Azure CLI is installed and configured with the necessary permissions to list and access VMs and disks.
PowerShell: The script is written for PowerShell. Ensure you have PowerShell installed on your system.
# How to Use the Script
Open PowerShell: Start by opening a PowerShell window. You may need to run PowerShell as an Administrator depending on your system's configuration.

Login to Azure: Ensure you are logged into your Azure account using the Azure CLI by running az login. Follow the prompts to complete the login process.

Run the Script: Copy the script into a PowerShell script file (e.g., CollectVMInfo.ps1) and execute it in your PowerShell window by navigating to the script's directory and running .\CollectVMInfo.ps1.

# Script Workflow
Define Scripts for VMs: The script sets commands to run on Windows and Linux VMs to collect volume and operating system information.

List Resource Groups: It lists all Azure resource groups in your subscription.

Prepare CSV File: A CSV file (vms_disk_volume_info.csv) is prepared to store the collected information. If the file exists, it's cleared to start fresh.

Collect Information: For each resource group, the script lists VMs and determines their OS type to decide which command to run. It then collects volume information from Windows VMs and disk usage from Linux VMs.

Parse and Export Data: The script parses the collected data, formats it, and exports it to the CSV file. It ensures that all relevant properties are included, adding placeholders where necessary to maintain consistent structure.

Disk Details: Additionally, the script fetches and adds details for each disk associated with the VMs, including disk name, size, and type.

# Output
The script outputs progress messages as it processes each resource group and VM.
Upon completion, it generates a CSV file named vms_disk_volume_info.csv containing combined disk and volume information from all processed VMs.
The CSV file includes headers for all properties collected or generated by the script, ensuring a comprehensive overview of disk and volume information across your Azure VMs.
# Customization
Scripts for VMs: You can modify the $windowsScriptToRun and $linuxScriptToRun variables to change or extend the information collected from VMs.
CSV File Path: The path to the CSV file is defined in $csvFilePath. You can change this path to suit your requirements.
Properties Collected: The script defines a set of properties to include in the CSV file. You can modify the $combinedProperties array to customize the output.
# Conclusion
This PowerShell script provides a streamlined approach to collecting and analyzing disk and volume information from Azure VMs. By automating the data collection process, it saves time and ensures consistency in how VM information is reported.
